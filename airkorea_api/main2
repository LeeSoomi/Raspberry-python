import requests

# 새로 발급받은 API 키
API_KEY = 'TkQMFutL1j3ZWjYAgIDgbG1XeVMfCXLIdmsj7WsACH5Ot03e7Bg9ovbUFK2P1NUaSVKiGh2sPubkybql6LRLQg%3D%3D'

# 요청 URL 및 파라미터 설정
url = 'http://apis.data.go.kr/B552584/ArpltnInforInqireSvc/getCtprvnRltmMesureDnsty'
params = {
    'serviceKey': API_KEY,
    'returnType': 'json',
    'numOfRows': 10,
    'pageNo': 1,
    'sidoName': '대전',
    'ver': '1.3'
}

# API 요청
response = requests.get(url, params=params)

# 응답 상태 코드 확인
print(f"Response Status Code: {response.status_code}")

# 응답 내용 확인 및 JSON 변환 시도
try:
    data = response.json()
    # 데이터 출력
    if data.get("response") and data["response"].get("body") and data["response"]["body"].get("items"):
        items = data["response"]["body"]["items"]
        for item in items:
            print(f"Station: {item['stationName']}, PM10: {item['pm10Value']}, PM2.5: {item['pm25Value']}, Time: {item['dataTime']}")
    else:
        print("No data available")
except requests.exceptions.JSONDecodeError as e:
    print("Error decoding JSON response:")
    print(response.text)
